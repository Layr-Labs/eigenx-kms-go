# EigenX KMS Vulnerability Summary

Snapshot of open issues from the 2025-10-31 audits (main + supplement). Use this as a quick reference when prioritizing fixes.

## Critical

1. **CRIT-004 – Reshare handlers unauthenticated**  
   Files: `pkg/node/handlers.go:350-410`. Anyone can POST fake commitments/shares because `/reshare/*` endpoints skip the BN254 authentication layer used elsewhere. Impact: remote compromise of key rotation.

2. **CRIT-001 – Dealer equivocation undetected**  
   File: `pkg/node/node.go:918-952`. `waitForAcknowledgements` only counts signatures; it never checks that all acknowledgement commitment hashes match. A malicious dealer can send inconsistent commitments, corrupting the master secret.

3. **CRIT-002 – Node ID collisions**  
   File: `pkg/node/node.go:35-40`. Node IDs truncate Keccak hashes to 64-bit signed integers. Collisions are feasible, enabling impersonation and share misrouting.

4. **CRIT-003 – RNG validation missing**  
   Files: `pkg/dkg/dkg.go:45-53`, `pkg/reshare/reshare.go:55-58`. `SetRandom` errors/entropy quality aren’t handled, so weak randomness could leak the master secret.

## High

5. **HIGH-001 – Commitment aggregation incomplete**  
   File: `pkg/dkg/dkg.go:91-125`. Only the first dealer’s commitments are used when deriving the master public key, yielding an incorrect key.

6. **HIGH-002 – Session timestamp replay gap**  
   File: `pkg/node/handlers.go:16-70`. Handlers do not verify session timestamps, so old protocol messages can be replayed across epochs.

7. **HIGH-003 – Commitment hash ignores Y coordinate**  
   File: `pkg/crypto/bls.go:165-171`. Hashing only the X coordinate permits crafted Y substitutions with the same digest.

8. **HIGH-004 – Reshare acknowledgements unverified**  
   File: `pkg/node/handlers.go:383-399`. Signatures on reshare acknowledgements are never checked, so attackers can fake progress.

9. **HIGH-005 – Reshare completion handler inert**  
   File: `pkg/node/handlers.go:401-410`. Logs completion but does not enforce checks or activate key versions, leaving protocol state inconsistent.

## Medium

10. **MED-001 – Session/global race**  
    Dual storage for protocol state can diverge when concurrent goroutines mutate it, risking inconsistent DKG/reshare tracking.

11. **MED-002 – Genesis DKG single point of failure**  
    Requires 100% operator participation; any offline node blocks bootstrap.

12. **MED-003 – No rate limiting**  
    All HTTP endpoints can be flooded, enabling DoS.

## Low

13. **LOW-001 – Sparse security logging**  
    Important events (failed auth, replay detection) aren’t logged with enough detail for audits.

14. **LOW-002 – Unbounded JSON payloads**  
    Lack of input size caps allows memory exhaustion.

15. **LOW-003 – Hard-coded timeouts**  
    Timeout values aren’t configurable, hindering tuning and defensive adjustments.

> Source: `eigenx-kms-security-summary.md` and supplement (audit date 2025-10-31).
